---
title: "assignment 10"
output: html_document
date: "2022-12-9"
---
# load packages
```{r}
library(tidyverse)
library(ggthemes)
library(rstatix)
library(ggpubr)
```

# download data into a dataframe called "assignment10"
#importing data
```{r}
assignment10 = read_csv("a10_data.csv")
```
#Yes, I can load the file

# Descriptives
```{r}
assignment10 %>% 
  group_by(subject, accessibility, distinctiveness) %>% 
  # or use group_by(subject, typeoftrial) %>%
  count()

length(assignment10 %>% pull(subject) %>% unique())
```
#Yes, but it shows n in each condition, so you need to add up n in all four conditions and prac to get the total n. Or use group_by(subject, typeoftrial) instead which shows n of test directly

#I changed ID to subject (ID didn't exist in data) and lenth to length to debug it, getting a total of 53 participants

#IVs
#I can tell from the overall code that there are 2 IVs, accessibility and distinctiveness, each has 2 levels--high or low

# Filtering
```{r}
main_data = assignment10 %>% filter(!is.na(accessibility)) %>%
  filter(!accessibility %in% "prac")

main_data %>% group_by(subject, accessibility, distinctiveness) %>% 
  count()
```
#No, it didn't filter out the prac tice trials. To debug it, I changed "practice" to "prac"

#Subject ratings
```{r}
main_data=main_data%>%
  mutate(response = as.numeric(response))
#Subject ratings
subject_rating = main_data %>% 
  group_by(subject, accessibility, distinctiveness) %>% 
  summarise(mean_rating = mean(response))
```
#No. To debug it, I changed response to numeric values using as.numeric()

#Count and mean_rating
```{r}
counts = main_data %>% 
  group_by(accessibility, distinctiveness) %>% 
  count()
#counts is the number of trials in each of the four accessibility-distinctiveness conditions 

mean_rating = main_data %>% 
  group_by(accessibility, distinctiveness) %>% 
  summarise(mean_rating = mean(response),
            sd_rating = sd(response))  %>%
  left_join(counts) %>%
  mutate(SE = sd_rating/n,
    ymin = mean_rating - 1.96*SE, 
        ymax = mean_rating + 1.96*SE)
```
#Yes, mean_rating includes the mean rating for each of the four conditions 

# Plot
```{r}
mean_rating %>%
  ggplot(aes(x = accessibility, y = mean_rating, 
             group = distinctiveness, fill = distinctiveness))+
  geom_col(position = "dodge")+
  geom_errorbar(aes(ymin = ymin, ymax = ymax),
                width = .25, 
                position = position_dodge(width=0.9))+
    geom_point(data = subject_rating, aes(x = accessibility, y = mean_rating, 
             group = distinctiveness),
             position = position_jitterdodge(jitter.width = 0.1),
             alpha = 0.3)+

  scale_fill_hc()+
  theme_few()
```
#The plot tells me the mean rating in four accessibility-distinctiveness conditions. 
#The mean rating is higher when distinctiveness is high than when it's low regardless of accessibility level. When accessibility is high, mean rating is higher when distinctiveness is high than when it's low. The same pattern holds when accessibility is low. When distinctiveness is high, mean rating is higher when accessibility is low than when it's high; But when distinctiveness is low, the mean rating is higher when accessibility is high than when it's low.

# ANOVA
```{r}
outliers = subject_rating %>%
  group_by(accessibility, distinctiveness) %>% 
  identify_outliers(mean_rating)
 
 sids = outliers %>% filter(is.extreme == TRUE) %>% pull(subject)
 
 subject_ratings_new = subject_rating %>% filter(!subject %in% sids)
 
subject_ratings_new %>%
  group_by(accessibility, distinctiveness) %>% 
   shapiro_test(mean_rating)
 
ggqqplot(subject_ratings_new, "mean_rating", ggtheme = theme_bw()) +
  facet_grid(accessibility ~ distinctiveness, labeller = "label_both")
#changed rating to mean_rating

## ANOVA for mean ratings as a function of accessibility and distinctiveness
subject_ratings_new=subject_ratings_new%>% ungroup()
#added ungroup()
rm.aov = anova_test(
  data = subject_ratings_new, dv = mean_rating, wid = subject,
  within = c(accessibility, distinctiveness)
  )
#changed RT to mean_rating, ID to subject, andc(weight, pathelength) to c(accessibility, distinctiveness)
get_anova_table(rm.aov)
```
#According to the ANOVA test, there is no significant main effect of accessibility as p is larger than 0.05, but there is a significant main effect of distinctiveness and a significant interaction between accessibility and distinctiveness.

```{r}
## posthoc
subject_ratings_new %>%
  group_by(accessibility) %>%
  anova_test(dv = mean_rating, wid = subject, within = distinctiveness) %>%
  get_anova_table() %>%
  adjust_pvalue(method = "bonferroni")
```
#I changed group_by(subject) to group_by(accessibility), and pathlength to distinctiveness


